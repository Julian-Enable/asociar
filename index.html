<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pago Seguro con Tarjeta</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>

<body>
    <div class="background-blobs">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>

    <main class="payment-container">
        <div class="card-preview">
            <div class="card-glass">
                <div class="card-header">
                    <span class="chip"></span>
                    <span class="logo">VISA</span>
                </div>
                <div class="card-body">
                    <div class="card-number-preview">•••• •••• •••• ••••</div>
                    <div class="card-details">
                        <div class="card-holder-preview">
                            <span class="label">Titular</span>
                            <span class="value">Nombre Apellido</span>
                        </div>
                        <div class="card-date-preview">
                            <span class="label">Expira</span>
                            <span class="value">MM/AA</span>
                        </div>
                    </div>
                    <i class="icon-card"></i>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group half">
                    <label for="cc-exp">Vencimiento</label>
                    <div class="input-wrapper">
                        <input type="text" id="cc-exp" name="cc-exp" autocomplete="cc-exp" placeholder="MM/AA"
                            maxlength="5" required>
                    </div>
                </div>

                <div class="form-group half">
                    <label for="cc-csc">CVC / CVV</label>
                    <div class="input-wrapper">
                        <input type="tel" id="cc-csc" name="cvc" autocomplete="cc-csc" placeholder="123"
                            pattern="[0-9]{3,4}" maxlength="4" inputmode="numeric">
                        <i class="icon-lock"></i>
                    </div>
                </div>
            </div>

            <button type="submit" class="pay-button">
                // Payment Request API for Google Pay
                const form = document.querySelector('.payment-form');

                form.addEventListener('submit', async (e) => {
                e.preventDefault();

                // Check if Payment Request API is supported
                if (!window.PaymentRequest) {
                alert('Payment Request API no soportada. El formulario se enviará normalmente.');
                form.submit();
                return;
                }

                try {
                const supportedInstruments = [{
                supportedMethods: 'basic-card',
                data: {
                supportedNetworks: ['visa', 'mastercard', 'amex'],
                supportedTypes: ['credit', 'debit']
                }
                }];

                const details = {
                total: {
                label: 'Total',
                amount: { currency: 'USD', value: '0.01' }
                }
                };

                const options = {
                requestPayerName: true,
                requestPayerEmail: false,
                requestPayerPhone: false
                };

                const request = new PaymentRequest(supportedInstruments, details, options);

                const response = await request.show();

                // Process payment response
                await response.complete('success');

                // Redirect to success
                window.location.href = '/success.html';

                } catch (err) {
                if (err.name !== 'AbortError') {
                console.error('Payment error:', err);
                // Fallback to normal form submission
                form.submit();
                }
                }
                });
                </script>
</body>

</html>